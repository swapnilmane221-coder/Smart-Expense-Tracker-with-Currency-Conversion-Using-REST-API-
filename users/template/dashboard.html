{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard</title>
  <link rel="stylesheet" href="{% static 'css/dashboard.css' %}" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-left">
      <span class="logo">ðŸ’¼</span>
      <span class="brand">EXPENSE</span>
    </div>
    <div class="nav-right">
      <a href="{% url 'expense-history' %}">Expense History</a>
      
      <a href="#" class="active">Dashboard</a>
      <a href="{% url 'add-expense' %}">Add Expense</a>
      
      <a href="{% url 'profile-setting' %}"><div class="avatar">ðŸ‘¤</div></a>
    </div>
  </nav>

  <main class="dashboard">
    <section class="dashboard-header">
      <h1>Dashboard</h1>
    </section>

    <!-- Top Row: Cards + Currency -->
    <section class="top-row">
      <div class="cards">
        <div class="card">
          <h2>â‚¹{{total_amount}}</h2>
          <p>Total Expenses</p>
        </div>
        <div class="card">
          <h2>{{transaction_count}}</h2>
          <p>Transactions</p>
        </div>
        <div class="card">
          <h2>{{ high_cat.category }}</h2>
          <p>Highest Category</p>
        </div>
      </div>

      <div class="currency-box">
        <h3>Currency Converter</h3>
        <div class="currency-controls">
          <select>
            <option>USD</option>
            <option>EUR</option>
            <option>GBP</option>
          </select>
          <input type="number" value="1" />
          <span>INR</span>
        </div>
        <div class="currency-rate">82.77</div>
      </div>
    </section>

    <!-- Charts -->
    <section class="charts">
      <div class="chart">
        <h3>Expenses by Category</h3>
        <canvas id="categoryChart"></canvas>
      </div>
      <div class="chart">
        <h3>Monthly Spending</h3>
        <canvas id="monthlyChart"></canvas>
      </div>
    </section>
  </main>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const categories = JSON.parse('{{ categories|escapejs }}');
  const amounts = JSON.parse('{{ amounts|escapejs }}');
  const months = JSON.parse('{{ months|escapejs }}');
  const monthlyAmounts = JSON.parse('{{ monthly_amounts|escapejs }}');

  // Doughnut Chart
  new Chart(document.getElementById("categoryChart"), {
    type: "doughnut",
    data: {
      labels: categories,
      datasets: [{
        data: amounts,
        backgroundColor: ["#2563eb", "#22c55e", "#facc15", "#ef4444"],
        borderWidth: 0
      }]
    },
    options: { responsive: true, plugins: { legend: { position: "bottom" } } }
  });

  // Bar Chart
  new Chart(document.getElementById("monthlyChart"), {
    type: "bar",
    data: {
      labels: months,
      datasets: [{
        label: "Spending",
        data: monthlyAmounts,
        backgroundColor: "#2563eb",
        borderRadius: 5
      }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true } } }
  });
</script>

</body>
</html>
